{{ header }}

<section class="section card">
    <div class="container">

        <div class="breadcrumbs">
            {% for breadcrumb in breadcrumbs %}
            {% if breadcrumb == breadcrumbs|first %}
            <a href="/">
                <svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <mask id="path-1-outside-1_84_10392" maskUnits="userSpaceOnUse" x="-0.0625" y="0" width="18"
                        height="16" fill="black">
                        <rect fill="white" x="-0.0625" width="18" height="16"></rect>
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M15.0619 9.03125L8.99968 2L2.9375 9.03125H3.99968V15H6.99962V10H10.9996V15H13.9997V9.03125H15.0619Z">
                        </path>
                    </mask>
                    <path
                        d="M8.99968 2L9.75705 1.34701L8.99968 0.468574L8.24231 1.34701L8.99968 2ZM15.0619 9.03125V10.0312H17.2444L15.8192 8.37826L15.0619 9.03125ZM2.9375 9.03125L2.18013 8.37826L0.754965 10.0312H2.9375V9.03125ZM3.99968 9.03125H4.99968V8.03125H3.99968V9.03125ZM3.99968 15H2.99968V16H3.99968V15ZM6.99962 15V16H7.99962V15H6.99962ZM6.99962 10V9H5.99962V10H6.99962ZM10.9996 10H11.9996V9H10.9996V10ZM10.9996 15H9.99962V16H10.9996V15ZM13.9997 15V16H14.9997V15H13.9997ZM13.9997 9.03125V8.03125H12.9997V9.03125H13.9997ZM8.24231 2.65299L14.3045 9.68424L15.8192 8.37826L9.75705 1.34701L8.24231 2.65299ZM3.69487 9.68424L9.75705 2.65299L8.24231 1.34701L2.18013 8.37826L3.69487 9.68424ZM3.99968 8.03125H2.9375V10.0312H3.99968V8.03125ZM2.99968 9.03125V15H4.99968V9.03125H2.99968ZM3.99968 16H6.99962V14H3.99968V16ZM7.99962 15V10H5.99962V15H7.99962ZM6.99962 11H10.9996V9H6.99962V11ZM9.99962 10V15H11.9996V10H9.99962ZM10.9996 16H13.9997V14H10.9996V16ZM14.9997 15V9.03125H12.9997V15H14.9997ZM15.0619 8.03125H13.9997V10.0312H15.0619V8.03125Z"
                        fill="#4F649A" mask="url(#path-1-outside-1_84_10392)"></path>
                </svg>
            </a>
            {% elseif breadcrumb == breadcrumbs|last %}
            <span>{{ breadcrumb.text }}</span>
            {% else %}
            <a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a>
            {% endif %}

            {% if breadcrumb != breadcrumbs|last %}
            <div class="breadcrumbs__separator"></div>
            {% endif %}
            {% endfor %}
        </div>

        <div class="card__container">
            <div class="card-image">
                <div class="swiper product-single-swiper">
                    <div class="swiper-wrapper">
                        {% for image in imagesMain %}
                        <div class="swiper-slide">
                            <div class="product-single-swiper__item">
                                <img src="{{ image.additional }}" alt="{{ heading_title }}" />
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="product-single-thumb-swiper-wrapper">
                    <div thumbsSlider="" class="swiper product-single-thumb-swiper">
                        <div class="swiper-wrapper">
                            {% for image in imagesMain %}
                            <div class="swiper-slide">
                                <div class="product-single-thumb-swiper__item">
                                    <img src="{{ image.additional }}" />
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-content">
                <div class="card-content__top">
                    <div class="card-content__subname">{{ model }}</div>
                    {% if stock == 'В наличии' %}
                    <div class="card-content__status check">{{ stock }}</div>
                    {% elseif stocl == 'Нет в наличии' %}
                    <div class="card-content__status">{{ stock }}</div>
                    {% endif %}
                </div>
                <h1 class="card-content__name">{{ heading_title }}</h1>
                <div class="card-content__info">
                    <div class="card-content__vendor">
                        {% if sku %}
                        <div class="card-content__vendor-name">Артикул:</div>
                        <div class="card-content__vendor-name">{{ sku }}</div>
                        {% endif %}
                    </div>
                    <div class="card-content__rating">
                        <div class="rating-area ">
                            <input type="radio" id="star-1" name="rating" value="1">
                            <label for="star-1" title="Оценка «1»"></label>
                            <input type="radio" id="star-2" name="rating" value="2">
                            <label for="star-2" title="Оценка «2»"></label>
                            <input type="radio" id="star-3" name="rating" value="3">
                            <label for="star-3" title="Оценка «3»"></label>
                            <input type="radio" id="star-4" name="rating" value="4">
                            <label for="star-4" title="Оценка «4»"></label>
                            <input type="radio" id="star-5" name="rating" value="5">
                            <label for="star-5" title="Оценка «5»"></label>
                        </div>
                        <div class="card-content__count-reviews">(10 отзывов)</div>
                    </div>
                </div>
                <!-- <div class="card-content__pirce">9.80 <span>руб</span></div>
                <div class="card-content__pirce">
                    <div class="card-content__pirce-new">9.80 <span>руб</span></div>
                    <div class="card-content__pirce-old">13 руб</div>
                </div> -->
                <div class="card-content__size">
                    <div class="card-content__size-name">Другие размеры</div>
                    <div class="card-content__size-items">
                        <div class="card-content__size-item">20 мм х ½''</div>
                        <div class="card-content__size-item">20 мм х ¾''</div>
                        <div class="card-content__size-item">26 мм х ¾''</div>
                        <div class="card-content__size-item">32 мм х 1''</div>
                        <div class="card-content__size-item">20 мм х ½''</div>
                        <div class="card-content__size-item">20 мм х ½''</div>
                        <div class="card-content__size-item">20 мм х ½''</div>
                    </div>
                </div>
                <div class="card-content__bottom">

                    <div class="card-product__count">
                        <button
                            class="btn-reset amount-minus card-product__count-button card-product__count-button-decrease">
                            <svg width="12" height="3" viewBox="0 0 12 3" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 1.5H11" stroke="#919191" stroke-width="1.5" stroke-linecap="round" />
                            </svg>
                        </button>
                        <input class="card-product__count-num" id="input-quantity{{ product.product_id }}" value="1"
                            size="2">
                        <button
                            class="btn-reset amount-plus card-product__count-button card-product__count-button-increase">
                            <svg width="12" height="13" viewBox="0 0 12 13" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 6.5H11" stroke="#919191" stroke-width="1.5" stroke-linecap="round" />
                                <path d="M6 1.5L6 11.5" stroke="#919191" stroke-width="1.5" stroke-linecap="round" />
                            </svg>
                        </button>
                    </div>

                    {% if theme_mt_category_product_cart_checked %}
                    <button class="btn-reset button2 card-content__other" id="button-cart">В корзину</button>
                    {% endif %}

                    
                    <!-- <button class="btn-reset button2 card-content__other check">Похожие товары</button> -->
                </div>

                {% if theme_mt_product_wishlist_checked %}
                <button class="btn-reset card-product__favourites"
                    onclick="{% if in_wishlist %}wishlist_remove('{{ product_id }}');{% else %}wishlist_add('{{ product_id }}');{% endif %} return false;"
                    {% if not logged %}data-login="false" {% else %}data-login="true" {% endif %}>
                    <div class="card-product__favourites-icon"></div>
                    <span>Добавить в избранное</span>
                </button>
                {% endif %}

            </div>
        </div>
    </div>
</section>

<section class="section block-info">
    <div class="container">
        <div class="tabs" data-tabs="tab">
            <ul class="list-reset tabs__nav">
                <li class="tabs__nav-item"><button class="btn-reset tabs__nav-btn" type="button">Описание</button></li>
                <li class="tabs__nav-item"><button class="btn-reset tabs__nav-btn" type="button">характеристики</button>
                </li>
                <li class="tabs__nav-item"><button class="btn-reset tabs__nav-btn" type="button">отзывы</button></li>
            </ul>
            <div class="tabs__content">
                <div class="tabs__panel">
                    <div class="tab-descr">
                        <ul class="list-reset tab-descr__inner">
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Заводской номер</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">4PN6789056</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Вид фитинга</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">угол</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Тип соединения</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">под пресс</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Угол, о</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">90</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Диаметр, мм</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">16×½'' BP</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Диаметр трубы</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">16 мм</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Вид резьбы</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">внутренняя</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Вид фитинга</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">угол</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Заводской номер</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">4PN6789056</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Угол, о</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">90</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Тип соединения</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">под пресс</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Вид резьбы</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">внутренняя</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Диаметр, мм</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">16×½'' BP</div>
                            </li>
                            <li class="tab-descr__item">
                                <div class="tab-descr__item-name">Диаметр трубы</div>
                                <div class="tab-descr__item-line"></div>
                                <div class="tab-descr__item-name">16 мм</div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="tabs__panel">
                    <div class="tab-content content">
                        {{ description }}
                    </div>
                </div>
                <div class="tabs__panel">
                    <!-- по макету может не быть -->
                    <div class="tab-reviews">
                        <div class="tab-reviews__item">
                            <div class="tab-reviews__item-top">
                                <div class="tab-reviews__item-name">Артур</div>
                                <div class="tab-reviews__item-date">20.10.2023</div>
                            </div>
                            <div class="tab-reviews__item-rating">
                                <div class="rating-area">
                                    <input type="radio" id="star-1" name="rating" value="1">
                                    <label for="star-1" title="Оценка «1»"></label>
                                    <input type="radio" id="star-2" name="rating" value="2">
                                    <label for="star-2" title="Оценка «2»"></label>
                                    <input type="radio" id="star-3" name="rating" value="3">
                                    <label for="star-3" title="Оценка «3»"></label>
                                    <input type="radio" id="star-4" name="rating" value="4">
                                    <label for="star-4" title="Оценка «4»"></label>
                                    <input type="radio" id="star-5" name="rating" value="5">
                                    <label for="star-5" title="Оценка «5»"></label>
                                </div>
                            </div>
                            <div class="tab-reviews__item-content">
                                <div class="tab-reviews__item-text js-tab-reviews-text">
                                    <p><b>Уголок с креплением пресс-гайка 16(2.0)*½» ш.</b> — предназначен для
                                        герметичного
                                        соединения участка трубопровода под углом 90* и переходом на внутреннюю резьбу с
                                        возможностью закрепления к стене. <br>
                                        Технология производства позволяет замоноличивать пресс-фитинги в стяжку или в
                                        стену.</p>
                                    <p><b>Уголок с креплением пресс-гайка 16(2.0)*½» ш.</b> — предназначен для
                                        герметичного
                                        соединения участка трубопровода под углом 90* и переходом на внутреннюю резьбу с
                                        возможностью закрепления к стене.
                                        Технология производства позволяет замоноличивать пресс-фитинги в стяжку или в
                                        стену.</p>
                                </div>
                                <button
                                    class="btn-reset button-link tab-reviews__item-button js-tab-reviews-button">Читать
                                    полностью</button>
                            </div>
                        </div>
                        <div class="tab-reviews__item">
                            <div class="tab-reviews__item-top">
                                <div class="tab-reviews__item-name">Пётр</div>
                                <div class="tab-reviews__item-date">20.10.2023</div>
                            </div>
                            <div class="tab-reviews__item-rating">
                                <div class="rating-area">
                                    <input type="radio" id="star-1" name="rating" value="1">
                                    <label for="star-1" title="Оценка «1»"></label>
                                    <input type="radio" id="star-2" name="rating" value="2">
                                    <label for="star-2" title="Оценка «2»"></label>
                                    <input type="radio" id="star-3" name="rating" value="3">
                                    <label for="star-3" title="Оценка «3»"></label>
                                    <input type="radio" id="star-4" name="rating" value="4">
                                    <label for="star-4" title="Оценка «4»"></label>
                                    <input type="radio" id="star-5" name="rating" value="5">
                                    <label for="star-5" title="Оценка «5»"></label>
                                </div>
                            </div>
                            <div class="tab-reviews__item-content">
                                <div class="tab-reviews__item-text js-tab-reviews-text">
                                    <p><b>Уголок с креплением пресс-гайка 16(2.0)*½» ш.</b> — предназначен для
                                        герметичного
                                        соединения участка трубопровода под углом 90* и переходом на внутреннюю резьбу с
                                        возможностью закрепления к стене. <br>
                                        Технология производства позволяет замоноличивать пресс-фитинги в стяжку или в
                                        стену.</p>
                                    <p><b>Уголок с креплением пресс-гайка 16(2.0)*½» ш.</b> — предназначен для
                                        герметичного
                                        соединения участка трубопровода под углом 90* и переходом на внутреннюю резьбу с
                                        возможностью закрепления к стене.
                                        Технология производства позволяет замоноличивать пресс-фитинги в стяжку или в
                                        стену.</p>
                                </div>
                                <button
                                    class="btn-reset button-link tab-reviews__item-button js-tab-reviews-button">Читать
                                    полностью</button>
                            </div>
                        </div>
                        <!-- по макету может не быть -->
                        <button class="btn-reset button2 tab-reviews__button">Добавить отзыв</button>
                    </div>
                    <!-- по макету может не быть -->
                    <form action="#" class="form tab-form">
                        <div class="form__text">У данного товара нет отзывов. Оставьте ваш отзыв первым. </div>
                        <label class="form__label">
                            <div class="form__span">Ваше имя</div>
                            <input type="text" name="" class="input-reset form__input" placeholder="Ваше имя">
                        </label>
                        <label class="form__label">
                            <div class="form__span">Email</div>
                            <input type="text" name="" class="input-reset form__input" placeholder="example@gmail.com">
                        </label>
                        <label class="form__label">
                            <div class="form__span">Заголовок</div>
                            <input type="text" name="" class="input-reset form__input"
                                placeholder="Напишите заголовок отзыва">
                        </label>
                        <div class="form__label tab-form__rating">
                            <div class="tab-form__rating-name">Оцените товар</div>
                            <div class="tab-form__rating-count">
                                <div class="rating-area ">
                                    <input type="radio" id="star-1" name="rating" value="1">
                                    <label for="star-1" title="Оценка «1»"></label>
                                    <input type="radio" id="star-2" name="rating" value="2">
                                    <label for="star-2" title="Оценка «2»"></label>
                                    <input type="radio" id="star-3" name="rating" value="3">
                                    <label for="star-3" title="Оценка «3»"></label>
                                    <input type="radio" id="star-4" name="rating" value="4">
                                    <label for="star-4" title="Оценка «4»"></label>
                                    <input type="radio" id="star-5" name="rating" value="5">
                                    <label for="star-5" title="Оценка «5»"></label>
                                </div>
                            </div>
                        </div>
                        <label class="form__label form__label-textarea">
                            <div class="form__span">Отзыв</div>
                            <textarea name="" id="" class="input-reset form__textarea"
                                placeholder="Оставьте ваш отзыв"></textarea>
                        </label>
                        <button class="btn-reset form__btn button2">Добавить отзыв</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>



{{ content_bottom }}

{{ content_top }}




<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"
    integrity="sha512-rstIgDs0xPgmG6RX1Aba4KV5cWJbAMcvRCVmglpam9SoHZiUCyQVDdH2LPlxoHtrv17XWblE/V/PP+Tr04hbtA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    function formValidate() {
        $('#questionProduct').validate({
            rules: {
                name: {
                    required: true,
                    minlength: 4,
                },
                phone: {
                    required: true,
                    minlength: 11,
                },
                question: {
                    required: true,
                    minlength: 10,
                }
            },
            messages: {
                name: {
                    required: "Поле не заполнено",
                    minlength: "Минимальное количество символов: 3"
                },
                phone: {
                    required: "Поле не заполнено",
                    minlength: "Минимальное количество символов: 11"
                },
                question: {
                    required: "Поле не заполнено",
                    minlength: "Минимальное количество символов: 10"
                }
            },
            errorPlacement: function (error, element) {
                error.appendTo(element.parent(".input_wrapper").next("p"));
            }
        });
    };
    formValidate();
    jQuery("#questionProduct").submit(function () {
        let form = jQuery(this);
        let name = jQuery(this).find('input[name="name"]');
        let phone = jQuery(this).find('input[name="phone"]');

        if ($('.input_wrapper__input').hasClass('error')) {
            phone.parent().addClass('not-valid');
            name.parent().addClass('not-valid');
        } else {
            jQuery.ajax({
                type: "POST",
                url: "index.php?route=mail/sendemail/send_form",
                data: form.serialize(),
                dataType: 'json',
                success: function (json) {
                    if (json['error']) {
                        message.html(json['error']);
                    }
                    if (json['success']) {
                        $('#questionProduct').parent().find('.product_page_info__title').text(
                            'Спасибо за заявку! Мы скоро с вами свяжемся')
                        $('#questionProduct').parent().find('.product_page_info__text').remove();
                        setTimeout(() => {
                            $('#questionProduct').remove();
                        }, 100);
                    }
                }
            });
            return false;
        }
    });
</script>

<script>
    // раскрывающийся текст 
    let more_text = $(".more-text");
    [].forEach.call(more_text, function (e) {
        let more_button = $(e).find("button.more-text_open");
        let get_content = $(e).find('.more-text_content').children();
        let get_overflow = $(e).find('.more-text_content').attr("data-overflow");
        let get_height = $(get_content).height();

        const def_button_text = $(more_button).text();

        $(get_content).css('max-height', get_overflow + 'px');

        if (get_overflow >= get_height) {
            $(more_button).css('display', 'none')
            $(more_button).remove();
        }

        console.log('ovf' + get_overflow)
        console.log('height' + get_height)

        const fix_height = get_overflow;

        $(more_button).click(function (e) {
            let this_content = $(e.currentTarget).parent().find('.more-text_content')
                .children();
            $(this_content).parent().toggleClass('open');
            $(this_content).parent().hasClass('open') ? ($(this_content).css('max-height', $(
                    this_content).prop('scrollHeight') + 'px')) & $(more_button).text(
                    'Свернуть') :
                $(this_content).css('max-height', fix_height + 'px') & $(more_button).text(
                    def_button_text)
        })
    });
</script>


<script type="text/javascript">
    <!--
    $('select[name=\'recurring_id\'], input[name="quantity"]').change(function () {
        $.ajax({
            url: 'index.php?route=product/product/getRecurringDescription',
            type: 'post',
            data: $(
                'input[name=\'product_id\'], input[name=\'quantity\'], select[name=\'recurring_id\']'
            ),
            dataType: 'json',
            beforeSend: function () {
                $('#recurring-description').html('');
            },
            success: function (json) {
                $('.alert-dismissible, .text-danger').remove();

                if (json['success']) {
                    $('#recurring-description').html(json['success']);
                }
            }
        });
    });
    //
    -->
</script>
<script type="text/javascript">
    $('#button-cart').on('click', function () {
        /*  console.log($(
             '#product input[type=\'text\'], #product input[type=\'hidden\'], #product input[type=\'radio\']:checked, #product input[type=\'checkbox\']:checked, #product select, #product textarea, #input-quantity'
             )); */
        $.ajax({
            url: 'index.php?route=checkout/cart/add',
            type: 'post',
            data: $(
                '#product input[type=\'text\'], #product input[type=\'hidden\'], #product input[type=\'radio\']:checked, #product input[type=\'checkbox\']:checked, #product select, #product textarea, #input-quantity'
            ),
            dataType: 'json',
            beforeSend: function () {
                //$('#button-cart').button('loading');
            },
            complete: function () {
                //$('#button-cart').button('reset');
            },
            success: function (json) {
                $('.alert-dismissible, .text-danger').remove();
                $('.form-group').removeClass('has-error');

                if (json['error']) {
                    if (json['error']['option']) {
                        for (i in json['error']['option']) {
                            var element = $('#input-option' + i.replace('_', '-'));

                            if (element.parent().hasClass('input-group')) {
                                element.parent().after('<div class="text-danger">' + json['error'][
                                    'option'
                                ][i] + '</div>');
                            } else {
                                element.after('<div class="text-danger">' + json['error']['option'][
                                    i
                                ] + '</div>');
                            }
                        }
                    }

                    if (json['error']['recurring']) {
                        $('select[name=\'recurring_id\']').after('<div class="text-danger">' + json[
                            'error']['recurring'] + '</div>');
                    }

                    // Highlight any found errors
                    $('.text-danger').parent().addClass('has-error');
                }

                if (json['success']) {
                    if ($("#cart_added").hasClass('notify_action')) {
                        $('#cart_added').removeClass('notify_action');
                    }
                    $(document).find('#cart_added').addClass('notify_action').css('top', 90 + 'px');
                    active_notify();
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

    function add_in_cart(product_id, quantity) {
        var btn = this;
        $.ajax({
            url: 'index.php?route=checkout/cart/add',
            type: 'post',
            data: 'product_id=' + product_id + '&quantity=' + (typeof (quantity) != 'undefined' ? quantity : 1),
            dataType: 'json',
            success: function (json) {

                if (json['redirect']) {
                    location = json['redirect'];
                }

                if (json['success']) {
                    if ($("#cart_added").hasClass('notify_action')) {
                        $('#cart_added').removeClass('notify_action');
                    }
                    $(document).find('#cart_added').addClass('notify_action').css('top', 90 + 'px');
                    active_notify();
                    $(btn).html('В корзине');
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    }
    //
</script>

<script type="text/javascript">
    /* $('.date').datetimepicker({
        language: '{{ datepicker }}',
        pickTime: false
    });

    $('.datetime').datetimepicker({
        language: '{{ datepicker }}',
        pickDate: true,
        pickTime: true
    });

    $('.time').datetimepicker({
        language: '{{ datepicker }}',
        pickDate: false
    }); */

    $('button[id^=\'button-upload\']').on('click', function () {
        var node = this;

        $('#form-upload').remove();

        $('body').prepend(
            '<form enctype="multipart/form-data" id="form-upload" style="display: none;"><input type="file" name="file" /></form>'
        );

        $('#form-upload input[name=\'file\']').trigger('click');

        if (typeof timer != 'undefined') {
            clearInterval(timer);
        }

        timer = setInterval(function () {
            if ($('#form-upload input[name=\'file\']').val() != '') {
                clearInterval(timer);

                $.ajax({
                    url: 'index.php?route=tool/upload',
                    type: 'post',
                    dataType: 'json',
                    data: new FormData($('#form-upload')[0]),
                    cache: false,
                    contentType: false,
                    processData: false,
                    beforeSend: function () {
                        $(node).button('loading');
                    },
                    complete: function () {
                        $(node).button('reset');
                    },
                    success: function (json) {
                        $('.text-danger').remove();

                        if (json['error']) {
                            $(node).parent().find('input').after(
                                '<div class="text-danger">' + json['error'] + '</div>');
                        }

                        if (json['success']) {
                            alert(json['success']);

                            $(node).parent().find('input').val(json['code']);
                        }
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr
                            .responseText);
                    }
                });
            }
        }, 500);
    });
</script>

<script type="text/javascript">
    $('#review').delegate('.pagination a', 'click', function (e) {
        e.preventDefault();

        $('#review').fadeOut('slow');

        $('#review').load(this.href);

        $('#review').fadeIn('slow');
    });

    $('#review').load('index.php?route=mt/product/product/review&id={{ product_id }}');

    $('#button-review').on('click', function () {
        $.ajax({
            url: '/index.php?route=product/product/write&product_id={{ product_id }}',
            type: 'post',
            dataType: 'json',
            data: $("#form-review").serialize(),
            beforeSend: function () {},
            complete: function () {},
            success: function (json) {
                $('.alert-dismissible').remove();

                if (json['error']) {
                    $('#review').after(
                        '<div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> ' +
                        json['error'] + '</div>');
                }

                if (json['success']) {
                    $('#review').after(
                        '<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ' +
                        json['success'] + '</div>');

                    $('input[name=\'name\']').val('');
                    $('textarea[name=\'text\']').val('');
                    $('input[name=\'rating\']:checked').prop('checked', false);
                }
            }
        });
    });
</script>
{{ footer }}


<script>
    //Изменение Toolbar для галереи
    /*  Fancybox.bind('[data-fancybox="prod"], [data-fancybox="prodMob"]', {
         compact: false,
         Carousel: {
             Navigation: false
         },
         Toolbar: {
             display: {
                 left: [],
                 middle: ["prev", "infobar", "next"],
                 right: ["close"],
             }
         }
     }); */
</script>